Here is the **fully expanded**, **technical**, and **offensive securityâ€“oriented** `README.md` for:

ğŸ“ `Error-Handling-Attacks-Juice-Shop/3-Missing-Custom-Error-Pages/Read-Me.md`

This version is designed to reflect practical red teaming methods, exploit methodology, and real-world security implications.

---

````markdown
# ğŸ”¥ 3 â€“ Missing Custom Error Pages

> ğŸ“‚ Path: `Error-Handling-Attacks-Juice-Shop/3-Missing-Custom-Error-Pages/`

---

## âš”ï¸ Description

When a web application does not implement custom error pages, it may expose **default error responses** generated by the web framework or underlying server. These pages often leak sensitive metadata such as:

- Web framework version
- Middleware stack
- File paths or route names
- Server type (e.g., Express, Django, Apache)

By **accessing non-existent paths or causing intentional routing failures**, an attacker can provoke these error responses and extract valuable reconnaissance data.

Such exposure violates **OWASP A06:2021 â€“ Vulnerable and Outdated Components** and **A09:2021 â€“ Security Logging and Monitoring Failures**.

---

## ğŸ§  Deep Technical PoC

### ğŸ¯ Objective

Exploit the lack of custom error handling by accessing invalid or undefined application routes and observing unhandled exceptions or raw 404/500 error pages.

---

### ğŸ› ï¸ Tools Used

| Tool           | Purpose                                                  |
|----------------|----------------------------------------------------------|
| ğŸ” **curl**        | Test HTTP responses for invalid routes                    |
| ğŸ§° **Burp Suite**  | Intercept and modify URL paths dynamically                |
| ğŸ”§ **Browser DevTools** | Inspect HTML-based error pages rendered in the browser |
| ğŸ§ª **Dirbuster / FFUF** | Optional for automated fuzzing of invalid endpoints     |

---

### ğŸ§ª Step-by-Step Attack Procedure

#### 1ï¸âƒ£ Start Juice Shop

```bash
docker run --rm -p 3000:3000 bkimminich/juice-shop
````

Browse to:

```
http://localhost:3000
```

---

#### 2ï¸âƒ£ Access Non-Existent Route

Use your browser, Burp, or curl to request a clearly invalid endpoint:

```bash
curl -i http://localhost:3000/super-secret-admin-portal
```

ğŸ“ Try multiple variations:

```bash
curl -i http://localhost:3000/../../etc/passwd
curl -i http://localhost:3000/404page
curl -i http://localhost:3000/trigger/server/failure
```

---

#### 3ï¸âƒ£ Observe HTTP Response

Look for:

* `HTTP/1.1 404 Not Found`
* `HTTP/1.1 500 Internal Server Error`
* Stack traces
* Debug output
* Error signatures like:

  * `Error: ENOENT`
  * `at Layer.handle [as handle_request]`
  * `X-Powered-By: Express`

Example output:

```html
Cannot GET /super-secret-admin-portal
```

Or:

```json
{
  "status": 500,
  "error": "Unhandled exception",
  "stack": "at Object.<anonymous> (/app/routes/product.js:42:15)"
}
```

---

#### 4ï¸âƒ£ Analyze Server Fingerprints

ğŸ“Œ Things to look for:

* Default error messages (e.g., `Cannot GET /invalid`)
* Full stack traces
* File paths with source code references
* Web framework (`Express`, `Node`, etc.)
* Disclosure of middleware (`Morgan`, `BodyParser`, etc.)
* Missing `Content-Security-Policy`, `X-Content-Type-Options`, etc.

---

## ğŸš© Hacker Insight

### ğŸ§© Whatâ€™s Exposed?

| Artifact                 | Risk Introduced                                |
| ------------------------ | ---------------------------------------------- |
| Express error stack      | Framework fingerprinting + file structure leak |
| No custom error handling | Server internals are publicly visible          |
| X-Powered-By: Express    | Technology exposure â†’ tailored exploit dev     |
| HTML 404 Template        | Injection into client-side error rendering     |

---

### ğŸ” Recon Enablement

* ğŸ‘ï¸â€ğŸ—¨ï¸ Identify framework version and possible CVEs
* ğŸ¯ Target specific known routes (e.g., `/admin`, `/debug`, `/console`)
* ğŸ§ª Fuzz endpoint enumeration using tools like **Dirbuster**, **gobuster**, or **FFUF**
* ğŸ” Locate route names or file paths from the error messages

---

### ğŸ§¨ Real-World CVEs & Incidents

* **[CVE-2018-3721](https://nvd.nist.gov/vuln/detail/CVE-2018-3721)** â€“ Express error messages leaking stack traces
* **Heroku App Misconfigurations** â€“ Exposed full backend trace via missing custom error handler
* **Apache Default Error Pages** â€“ Showed version, modules, and doc root path

---

## ğŸ’£ Exploit Demo Video

*Add a short video or GIF demonstrating:*

* Firing `/invalidpath` in Burp or browser
* Observing backend leak (`Cannot GET`, stack trace)

---

## ğŸ›¡ï¸ Mitigation Recommendations

| Remediation                      | Benefit                                       |
| -------------------------------- | --------------------------------------------- |
| âœ… Use centralized error handler  | Ensures consistent, controlled error feedback |
| ğŸš« Remove `X-Powered-By` headers | Prevents framework fingerprinting             |
| ğŸ” Sanitize error output         | Avoid leaking stack traces, file names        |
| ğŸ­ Return generic 404/500 pages  | Prevent info disclosure to client             |

Node.js Express Example:

```js
app.use((err, req, res, next) => {
  logger.error(err.stack);
  res.status(500).send('Something went wrong.');
});
```

---

## ğŸ§­ Mapping to Offensive Security Domains

| Category               | Value to Attacker                          |
| ---------------------- | ------------------------------------------ |
| Reconnaissance         | Technology stack fingerprinting            |
| Web App Pentesting     | Enumeration of hidden or sensitive routes  |
| Red Teaming            | Chaining with brute-force endpoint fuzzing |
| AppSec Misconfig Audit | Detecting lack of production hardening     |

---

## ğŸ“‚ Suggested Repo Artifacts

* `invalid_routes_tested.txt` â€“ List of endpoints and responses
* `curl_outputs.log` â€“ Raw response capture with error codes
* `burp_screenshots/` â€“ UI-based invalid path access
* `express_headers.log` â€“ Captured server response headers
* `error_page_dumps.html` â€“ Saved raw HTML of default 404/500 pages

---

## ğŸ§  Author

**ğŸ‘¨â€ğŸ’» Shajohn16**
OffSec Researcher | Web App Security Analyst | Express Recon Expert
*GitHub: [@Shajohn16](https://github.com/Shajohn16)*

---

```

```
