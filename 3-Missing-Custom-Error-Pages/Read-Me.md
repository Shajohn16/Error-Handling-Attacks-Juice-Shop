Here is the **fully expanded**, **technical**, and **offensive security–oriented** `README.md` for:

📁 `Error-Handling-Attacks-Juice-Shop/3-Missing-Custom-Error-Pages/Read-Me.md`

This version is designed to reflect practical red teaming methods, exploit methodology, and real-world security implications.

---

````markdown
# 🔥 3 – Missing Custom Error Pages

> 📂 Path: `Error-Handling-Attacks-Juice-Shop/3-Missing-Custom-Error-Pages/`

---

## ⚔️ Description

When a web application does not implement custom error pages, it may expose **default error responses** generated by the web framework or underlying server. These pages often leak sensitive metadata such as:

- Web framework version
- Middleware stack
- File paths or route names
- Server type (e.g., Express, Django, Apache)

By **accessing non-existent paths or causing intentional routing failures**, an attacker can provoke these error responses and extract valuable reconnaissance data.

Such exposure violates **OWASP A06:2021 – Vulnerable and Outdated Components** and **A09:2021 – Security Logging and Monitoring Failures**.

---

## 🧠 Deep Technical PoC

### 🎯 Objective

Exploit the lack of custom error handling by accessing invalid or undefined application routes and observing unhandled exceptions or raw 404/500 error pages.

---

### 🛠️ Tools Used

| Tool           | Purpose                                                  |
|----------------|----------------------------------------------------------|
| 🔍 **curl**        | Test HTTP responses for invalid routes                    |
| 🧰 **Burp Suite**  | Intercept and modify URL paths dynamically                |
| 🔧 **Browser DevTools** | Inspect HTML-based error pages rendered in the browser |
| 🧪 **Dirbuster / FFUF** | Optional for automated fuzzing of invalid endpoints     |

---

### 🧪 Step-by-Step Attack Procedure

#### 1️⃣ Start Juice Shop

```bash
docker run --rm -p 3000:3000 bkimminich/juice-shop
````

Browse to:

```
http://localhost:3000
```

---

#### 2️⃣ Access Non-Existent Route

Use your browser, Burp, or curl to request a clearly invalid endpoint:

```bash
curl -i http://localhost:3000/super-secret-admin-portal
```

📍 Try multiple variations:

```bash
curl -i http://localhost:3000/../../etc/passwd
curl -i http://localhost:3000/404page
curl -i http://localhost:3000/trigger/server/failure
```

---

#### 3️⃣ Observe HTTP Response

Look for:

* `HTTP/1.1 404 Not Found`
* `HTTP/1.1 500 Internal Server Error`
* Stack traces
* Debug output
* Error signatures like:

  * `Error: ENOENT`
  * `at Layer.handle [as handle_request]`
  * `X-Powered-By: Express`

Example output:

```html
Cannot GET /super-secret-admin-portal
```

Or:

```json
{
  "status": 500,
  "error": "Unhandled exception",
  "stack": "at Object.<anonymous> (/app/routes/product.js:42:15)"
}
```

---

#### 4️⃣ Analyze Server Fingerprints

📌 Things to look for:

* Default error messages (e.g., `Cannot GET /invalid`)
* Full stack traces
* File paths with source code references
* Web framework (`Express`, `Node`, etc.)
* Disclosure of middleware (`Morgan`, `BodyParser`, etc.)
* Missing `Content-Security-Policy`, `X-Content-Type-Options`, etc.

---

## 🚩 Hacker Insight

### 🧩 What’s Exposed?

| Artifact                 | Risk Introduced                                |
| ------------------------ | ---------------------------------------------- |
| Express error stack      | Framework fingerprinting + file structure leak |
| No custom error handling | Server internals are publicly visible          |
| X-Powered-By: Express    | Technology exposure → tailored exploit dev     |
| HTML 404 Template        | Injection into client-side error rendering     |

---

### 🔍 Recon Enablement

* 👁️‍🗨️ Identify framework version and possible CVEs
* 🎯 Target specific known routes (e.g., `/admin`, `/debug`, `/console`)
* 🧪 Fuzz endpoint enumeration using tools like **Dirbuster**, **gobuster**, or **FFUF**
* 🔍 Locate route names or file paths from the error messages

---

### 🧨 Real-World CVEs & Incidents

* **[CVE-2018-3721](https://nvd.nist.gov/vuln/detail/CVE-2018-3721)** – Express error messages leaking stack traces
* **Heroku App Misconfigurations** – Exposed full backend trace via missing custom error handler
* **Apache Default Error Pages** – Showed version, modules, and doc root path

---

## 💣 Exploit Demo Video

*Add a short video or GIF demonstrating:*

* Firing `/invalidpath` in Burp or browser
* Observing backend leak (`Cannot GET`, stack trace)

---

## 🛡️ Mitigation Recommendations

| Remediation                      | Benefit                                       |
| -------------------------------- | --------------------------------------------- |
| ✅ Use centralized error handler  | Ensures consistent, controlled error feedback |
| 🚫 Remove `X-Powered-By` headers | Prevents framework fingerprinting             |
| 🔐 Sanitize error output         | Avoid leaking stack traces, file names        |
| 🎭 Return generic 404/500 pages  | Prevent info disclosure to client             |

Node.js Express Example:

```js
app.use((err, req, res, next) => {
  logger.error(err.stack);
  res.status(500).send('Something went wrong.');
});
```

---

## 🧭 Mapping to Offensive Security Domains

| Category               | Value to Attacker                          |
| ---------------------- | ------------------------------------------ |
| Reconnaissance         | Technology stack fingerprinting            |
| Web App Pentesting     | Enumeration of hidden or sensitive routes  |
| Red Teaming            | Chaining with brute-force endpoint fuzzing |
| AppSec Misconfig Audit | Detecting lack of production hardening     |

---

## 📂 Suggested Repo Artifacts

* `invalid_routes_tested.txt` – List of endpoints and responses
* `curl_outputs.log` – Raw response capture with error codes
* `burp_screenshots/` – UI-based invalid path access
* `express_headers.log` – Captured server response headers
* `error_page_dumps.html` – Saved raw HTML of default 404/500 pages

---

## 🧠 Author

**👨‍💻 Shajohn16**
OffSec Researcher | Web App Security Analyst | Express Recon Expert
*GitHub: [@Shajohn16](https://github.com/Shajohn16)*

---

```

```
